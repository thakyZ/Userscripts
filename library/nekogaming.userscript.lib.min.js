"undefined"!=typeof window&&(window.onload=function(){"undefined"==typeof jQuery&&console.warn("JQuery not loaded do not process.")}),function(t,e){"use strict";function n(t,e){return new Promise((n,o)=>{const s=new XMLHttpRequest;s.open(t,e),s.onload=function(){this.readyState===this.DONE&&this.status>=200&&this.status<300?n(s.responseText):o(new Error({status:this.status,statusText:s.statusText}))},s.onerror=function(){o(new Error({status:this.status,statusText:s.statusText}))},s.send()})}let o=!1;String.prototype.width=function(e,n){const o=e||"arial",s=n||"12px",r=t("<span></span>").text(this).css({position:"absolute",float:"left",whiteSpace:"nowrap",visibility:"hidden",font:`${s} ${o}`}).appendTo(t("body")),a=r.width();return r.remove(),a},t.fn.setData=function(n,o){return t(this).each((s,r)=>{const a=t(r).data(n)===e?{}:t(this).data(n);a===e&&t(r).data(n,{});for(const[t,e]of Object.entries(o))!Object.prototype.hasOwnProperty.call(o,t)&&Object.prototype.hasOwnProperty.call(o,t)||(a[t]=e);t(r).data(n,a)}),t(this)},t.fn.addData=function(n,o){return t(this).each((s,r)=>{const a=t(r).data(n)===e?{}:t(this).data(n);a===e&&t(r).data(n,{});for(const[t,e]of Object.entries(o))Object.prototype.hasOwnProperty.call(a,t)||(a[t]=e);t(r).data(n,a)}),t(this)},t.fn.removeData=function(n,o){return t(this).each((s,r)=>{const a=t(r).data(n)===e?{}:t(r).data(n);for(const t of o)Object.prototype.hasOwnProperty.call(a,t)&&a.delete(t);t(r).data(n,a)}),t(this)},t.fn.modifyStyle=function(e){return t(this).each((n,o)=>{const s=t(o).data(e);let r="";for(const[t,e]of Object.entries(s))Object.prototype.hasOwnProperty.call(s,t)&&(r+=`--${t}: ${e}; `);t(o).text(`:root { ${r}}`)}),t(this)},t.fn.createElement=((n,o={})=>{const s=GM_getResourceText(n);if(""===s)return e;const r=s.replaceAll(/^<!DOCTYPE html>\r?\n<template>\r?\n {2}/gi,"").replaceAll(/\r?\n<\/template>$/gi,"");let a=t("<div />").append(t(r).clone()).html();for(const[t,e]of Object.entries(o))a=a.replaceAll(t,e);return t(a)}),t.fn.getUserNameAlts=(async(t,e)=>{let o="";if("undefined"==typeof GM||void 0===GM.xmlHttpRequest)try{const s=await n("GET",`https://api.nekogaming.xyz/ffxiv/modding/names/get.php?q=${t}&id=${e}`);o=JSON.parse(s)}catch(t){console.error("Failed to get the user's avatar. (Non-GreaseMonkey)"),console.error(t)}else try{const n=await GM.xmlHttpRequest({method:"GET",url:`https://api.nekogaming.xyz/ffxiv/modding/names/get.php?q=${t}&id=${e}`,responseType:"",synchronous:!0,timeout:2e3});n.readyState===n.DONE&&n.status>=200&&n.status<300&&(o=JSON.parse(n.responseText))}catch(t){console.error("Failed to get the user's avatar. (GreaseMonkey)"),console.error(t)}return o}),t.fn.getObjectAttr=function(...e){if(0===e.length){if(0===this.length)return null;const e={};return t.each(this,function(n){t.each(this[n].attributes,function(){this.specified&&(e[this.name]=this.value)})}),e}},t.fn.onlyText=(e=>t(e).clone().children().remove().end().text()),t.fn.detectOriginalText=function(e){return o&&console.log(`detectedStrings : ${t(e).length}`),t(e)},t.fn.toggleDebug=function(){o=!o}}(jQuery);